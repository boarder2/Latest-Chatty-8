<Page x:Class="Latest_Chatty_8.Shell"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="using:Latest_Chatty_8"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      DataContext="{Binding RelativeSource={RelativeSource Self}}"
      mc:Ignorable="d">

	<Page.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<ResourceDictionary Source="ms-appx:///Styles/SplitViewStyles.xaml" />
			</ResourceDictionary.MergedDictionaries>
		</ResourceDictionary>
	</Page.Resources>
	<Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
		<VisualStateManager.VisualStateGroups>
			<VisualStateGroup>
				<VisualState x:Name="VisualStatePhone">
					<VisualState.StateTriggers>
						<AdaptiveTrigger MinWindowWidth="0" />
					</VisualState.StateTriggers>
					<VisualState.Setters>
						<Setter Target="splitter.DisplayMode" Value="Overlay" />
						<Setter Target="updateFlyout.MaxWidth" Value="320" />
					</VisualState.Setters>
				</VisualState>
				<VisualState x:Name="VisualStateMid">
					<VisualState.StateTriggers>
						<AdaptiveTrigger MinWindowWidth="600" />
					</VisualState.StateTriggers>
				</VisualState>
				<VisualState x:Name="VisualStateBig">
					<VisualState.StateTriggers>
						<AdaptiveTrigger MinWindowWidth="800" />
					</VisualState.StateTriggers>
				</VisualState>
			</VisualStateGroup>
		</VisualStateManager.VisualStateGroups>
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="*" />
			</Grid.RowDefinitions>
			<Grid>
				<Grid.Background>
					<SolidColorBrush Color="{x:Bind Path=Settings.Theme.AccentBackgroundColor, Mode=OneWay}" />
				</Grid.Background>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="Auto" />
				</Grid.ColumnDefinitions>
				<StackPanel Grid.Column="0" Orientation="Horizontal">
					<ToggleButton x:Name="BurguerToggle"
					              Grid.Row="0"
					              Margin="4"
					              Background="Transparent"
					              IsChecked="False"
					              ToolTipService.ToolTip="Toggle Sidebar">
						<FontIcon x:Name="Hamburger"
						          FontFamily="Segoe MDL2 Assets"
						          Glyph="" />
					</ToggleButton>
					<Button Click="BackClicked" IsEnabled="{Binding ElementName=splitter, Path=Content.CanGoBack}" FontFamily="Segoe MDL2 Assets" Content="" />
					<TextBlock Margin="6,0,0,0"
					           VerticalAlignment="Center"
					           Text="{x:Bind Path=CurrentViewName, Mode=OneWay}" />
				</StackPanel>
				<Button x:Name="updateInfoAvailableButton"
				        Grid.Column="1"
				        Content=""
				        Style="{StaticResource InlineButton}"
				        ToolTipService.ToolTip="New Version Info"
				        Visibility="{x:Bind Path=Settings.IsUpdateInfoAvailable, Mode=OneWay, Converter={StaticResource BoolToVisConverter}}">
					<Button.Flyout>
						<Flyout>
							<Flyout.FlyoutPresenterStyle>
								<Style TargetType="FlyoutPresenter">
									<Setter Property="MaxWidth" Value="768" />
								</Style>
							</Flyout.FlyoutPresenterStyle>
							<Grid x:Name="updateFlyout" MaxWidth="750">
								<StackPanel Orientation="Vertical">
									<TextBlock Text="{x:Bind Path=Settings.UpdateInfo}" TextWrapping="Wrap" />
									<Button HorizontalAlignment="Right"
									        Click="AcknowledgeUpdateInfoClicked"
									        Content="Got it!" />
								</StackPanel>
							</Grid>
						</Flyout>
					</Button.Flyout>
				</Button>
			</Grid>
			<SplitView x:Name="splitter"
			           Grid.Row="1"
			           DisplayMode="CompactOverlay"
			           IsPaneOpen="{Binding IsChecked,
			                                ElementName=BurguerToggle,
			                                Mode=TwoWay}"
			           OpenPaneLength="320"
			           PanePlacement="Left">
				<SplitView.PaneBackground>
					<SolidColorBrush Color="{x:Bind Path=Settings.Theme.AccentBackgroundColor, Mode=OneWay}" />
				</SplitView.PaneBackground>
				<SplitView.Pane>
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="*" />
							<RowDefinition Height="Auto" />
						</Grid.RowDefinitions>
						<StackPanel Grid.Row="0">
							<Grid>
								<RadioButton x:Name="chattyRadio"
								             Click="ClickedNav"
								             Content="Chatty"
								             GroupName="NavGroup"
								             Style="{StaticResource SplitViewRadioButtonStyle}"
								             ToolTipService.ToolTip="Chatty">
									<RadioButton.Tag>
										<TextBlock Style="{StaticResource SplitViewTextBlockStyle}" Text="" />
									</RadioButton.Tag>
								</RadioButton>
							</Grid>
							<Grid Visibility="{x:Bind Path=AuthManager.LoggedIn, Converter={StaticResource BoolToVisConverter}, Mode=OneWay}">
								<TextBlock Text="{x:Bind Path=MessageManager.UnreadCount, Mode=OneWay}" Visibility="{x:Bind Path=MessageManager.UnreadCount, Converter={StaticResource GreaterThanZeroVisibilityConverter}, Mode=OneWay}" />

								<RadioButton x:Name="messagesRadio"
								             Click="ClickedNav"
								             Content="Messages"
								             GroupName="NavGroup"
								             Style="{StaticResource SplitViewRadioButtonStyle}"
								             ToolTipService.ToolTip="Messages">
									<RadioButton.Tag>
										<TextBlock Style="{StaticResource SplitViewTextBlockStyle}" Text="" />
									</RadioButton.Tag>
								</RadioButton>
							</Grid>
							<Grid Visibility="{x:Bind Path=AuthManager.LoggedIn, Converter={StaticResource BoolToVisConverter}, Mode=OneWay}">
								<RadioButton x:Name="tagRadio"
								             Click="ClickedNav"
								             Content="Tags"
								             GroupName="NavGroup"
								             Style="{StaticResource SplitViewRadioButtonStyle}"
								             ToolTipService.ToolTip="Tags">
									<RadioButton.Tag>
										<TextBlock Style="{StaticResource SplitViewTextBlockStyle}" Text="" />
									</RadioButton.Tag>
								</RadioButton>
							</Grid>
						</StackPanel>
						<StackPanel Grid.Row="1">
							<RadioButton x:Name="helpRadio"
							             VerticalAlignment="Bottom"
							             Click="ClickedNav"
							             Content="Help"
							             GroupName="NavGroup"
							             Style="{StaticResource SplitViewRadioButtonStyle}"
							             ToolTipService.ToolTip="Help/About">
								<RadioButton.Tag>
									<TextBlock Style="{StaticResource SplitViewTextBlockStyle}" Text="" />
								</RadioButton.Tag>
							</RadioButton>
							<RadioButton x:Name="settingsRadio"
							             VerticalAlignment="Bottom"
							             Click="ClickedNav"
							             Content="Settings"
							             GroupName="NavGroup"
							             Style="{StaticResource SplitViewRadioButtonStyle}"
							             ToolTipService.ToolTip="Settings">
								<RadioButton.Tag>
									<TextBlock Style="{StaticResource SplitViewTextBlockStyle}" Text="" />
								</RadioButton.Tag>
							</RadioButton>
						</StackPanel>
					</Grid>
				</SplitView.Pane>
			</SplitView>
		</Grid>

	</Grid>
</Page>
